module TestExamples1DMHD

using Test
using Trixi

include("test_trixi.jl")

# pathof(Trixi) returns /path/to/Trixi/src/Trixi.jl, dirname gives the parent directory
EXAMPLES_DIR = joinpath(pathof(Trixi) |> dirname |> dirname, "examples", "tree_1d_dgsem")

@testset "MHD Multi-ion" begin
#! format: noindent

@trixi_testset "elixir_mhdmultiion_ec_onespecies.jl" begin
    @test_trixi_include(joinpath(EXAMPLES_DIR, "elixir_mhdmultiion_ec_onespecies.jl"),
                        l2=[
                            4.1304627304940003e-17,
                            5.4681492967955873e-02,
                            5.4681492967955873e-02,
                            5.8034794143785734e-02,
                            8.1686107656040716e-02,
                            5.4627972898756594e-02,
                            5.4627972898756594e-02,
                            1.5559804954845133e-01
                        ],
                        linf=[
                            1.1102230246251565e-16,
                            1.0756082592909055e-01,
                            1.0756082592909055e-01,
                            1.1699453974473184e-01,
                            1.8782944777819507e-01,
                            9.8288863211692001e-02,
                            9.8288863211692001e-02,
                            4.3538944922452361e-01
                        ])
end

@trixi_testset "elixir_mhdmultiion_ec.jl" begin
    @test_trixi_include(joinpath(EXAMPLES_DIR, "elixir_mhdmultiion_ec.jl"),
                        l2=[
                            4.1304627304940003e-17,
                            4.3626365427359211e-02,
                            4.3597997802536363e-02,
                            2.3507245682869861e-02,
                            4.6610769145871714e-02,
                            1.4848843852905394e-02,
                            1.7839683917849288e-02,
                            1.3457845268573115e-01,
                            3.8214585380506302e-02,
                            5.2755332770791419e-02,
                            3.3071810251645600e-02,
                            3.0160701292947324e-02,
                            8.5619654328485756e-02
                        ],
                        linf=[
                            1.1102230246251565e-16,
                            9.1215410389221874e-02,
                            9.1205447402732065e-02,
                            7.1152999945483464e-02,
                            1.2176089138259275e-01,
                            3.2242944708070438e-02,
                            3.8890545935514498e-02,
                            3.4213021755787931e-01,
                            8.5324175333816754e-02,
                            1.0941185893660356e-01,
                            6.7106846800977699e-02,
                            6.0449563579190013e-02,
                            1.8998760735672127e-01
                        ])
end

@trixi_testset "elixir_mhdmultiion_es.jl" begin
    @test_trixi_include(joinpath(EXAMPLES_DIR, "elixir_mhdmultiion_es.jl"),
                        l2=[
                            4.1304627304940003e-17,
                            4.2553038586026444e-02,
                            4.2527236533326879e-02,
                            2.3251091453701061e-02,
                            4.4654486530370789e-02,
                            1.4619805774071728e-02,
                            1.7643391664085059e-02,
                            1.2712914702892930e-01,
                            3.8469247812943669e-02,
                            5.2336025462555114e-02,
                            3.2727028006044219e-02,
                            2.9776912791966450e-02,
                            8.4012739159795263e-02
                        ],
                        linf=[
                            1.1102230246251565e-16,
                            8.2210559138160888e-02,
                            8.2218565022087908e-02,
                            6.5729098364666283e-02,
                            1.1094270689375808e-01,
                            2.4700103166055636e-02,
                            3.2091406020875547e-02,
                            3.1521158925312243e-01,
                            8.5168856942823057e-02,
                            1.0770235761746386e-01,
                            5.1134001263296432e-02,
                            4.3948680822294889e-02,
                            1.6265858425106705e-01
                        ])
end

@trixi_testset "elixir_mhdmultiion_es_shock_capturing.jl" begin
    @test_trixi_include(joinpath(EXAMPLES_DIR,
                                 "elixir_mhdmultiion_es_shock_capturing.jl"),
                        l2=[
                            4.1304627304940003e-17,
                            4.2551420656608052e-02,
                            4.2525625623064091e-02,
                            2.3250220525587818e-02,
                            4.4653027389729920e-02,
                            1.4619390203068858e-02,
                            1.7642992953968012e-02,
                            1.2712366369768024e-01,
                            3.8467995219616406e-02,
                            5.2334692216684658e-02,
                            3.2726030774880857e-02,
                            2.9775868343442317e-02,
                            8.4007321361367848e-02
                        ],
                        linf=[
                            1.1102230246251565e-16,
                            8.2196712187582066e-02,
                            8.2204692538675128e-02,
                            6.5725380494179808e-02,
                            1.1093829329448765e-01,
                            2.4696553126525956e-02,
                            3.2087364118652505e-02,
                            3.1519746333592513e-01,
                            8.5161488531380058e-02,
                            1.0769856292976031e-01,
                            5.1128616588110090e-02,
                            4.3943599376482068e-02,
                            1.6265341537651956e-01
                        ])
end
end

end # module
