<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>16 Explicit time stepping · Trixi.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://trixi-framework.github.io/Trixi.jl/stable/tutorials\\time_stepping.html"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Trixi.jl</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../overview.html">Overview</a></li><li><a class="tocitem" href="../visualization.html">Visualization</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="introduction.html">Introduction</a></li><li><a class="tocitem" href="getting_started_with_Trixi.html">1 Getting started with Trixi</a></li><li><a class="tocitem" href="scalar_linear_advection_1d.html">2 Introduction to DG methods</a></li><li><a class="tocitem" href="DGSEM_FluxDiff.html">3 DGSEM with flux differencing</a></li><li><a class="tocitem" href="shock_capturing.html">4 Shock capturing with flux differencing and stage limiter</a></li><li><a class="tocitem" href="non_periodic_boundaries.html">5 Non-periodic boundaries</a></li><li><a class="tocitem" href="DGMulti_1.html">6 DG schemes via <code>DGMulti</code> solver</a></li><li><a class="tocitem" href="DGMulti_2.html">7 Other SBP schemes (FD, CGSEM) via <code>DGMulti</code> solver</a></li><li><a class="tocitem" href="upwind_fdsbp.html">8 Upwind FD SBP schemes</a></li><li><a class="tocitem" href="adding_new_scalar_equations.html">9 Adding a new scalar conservation law</a></li><li><a class="tocitem" href="adding_nonconservative_equation.html">10 Adding a non-conservative equation</a></li><li><a class="tocitem" href="parabolic_terms.html">11 Parabolic terms</a></li><li><a class="tocitem" href="adding_new_parabolic_terms.html">12 Adding new parabolic terms</a></li><li><a class="tocitem" href="adaptive_mesh_refinement.html">13 Adaptive mesh refinement</a></li><li><a class="tocitem" href="structured_mesh_mapping.html">14 Structured mesh with curvilinear mapping</a></li><li><a class="tocitem" href="hohqmesh_tutorial.html">15 Unstructured meshes with HOHQMesh.jl</a></li><li class="is-active"><a class="tocitem" href="time_stepping.html">16 Explicit time stepping</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Error-based-adaptive-step-sizes"><span>Error-based adaptive step sizes</span></a></li><li class="toplevel"><a class="tocitem" href="#CFL-based-step-size-control"><span>CFL-based step size control</span></a></li></ul></li><li><a class="tocitem" href="differentiable_programming.html">17 Differentiable programming</a></li></ul></li><li><span class="tocitem">Basic building blocks</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Meshes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../meshes/tree_mesh.html">Tree mesh</a></li><li><a class="tocitem" href="../meshes/structured_mesh.html">Structured mesh</a></li><li><a class="tocitem" href="../meshes/unstructured_quad_mesh.html">Unstructured mesh</a></li><li><a class="tocitem" href="../meshes/p4est_mesh.html">P4est-based mesh</a></li><li><a class="tocitem" href="../meshes/dgmulti_mesh.html">DGMulti mesh</a></li></ul></li><li><a class="tocitem" href="../time_integration.html">Time integration</a></li><li><a class="tocitem" href="../callbacks.html">Callbacks</a></li></ul></li><li><span class="tocitem">Advanced topics &amp; developers</span><ul><li><a class="tocitem" href="../conventions.html">Conventions</a></li><li><a class="tocitem" href="../development.html">Development</a></li><li><a class="tocitem" href="../github-git.html">GitHub &amp; Git</a></li><li><a class="tocitem" href="../styleguide.html">Style guide</a></li><li><a class="tocitem" href="../testing.html">Testing</a></li><li><a class="tocitem" href="../performance.html">Performance</a></li><li><a class="tocitem" href="../parallelization.html">Parallelization</a></li></ul></li><li><a class="tocitem" href="../troubleshooting.html">Troubleshooting and FAQ</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../reference-trixi.html">Trixi.jl</a></li><li><a class="tocitem" href="../reference-trixi2vtk.html">Trixi2Vtk.jl</a></li></ul></li><li><a class="tocitem" href="../authors.html">Authors</a></li><li><a class="tocitem" href="../contributing.html">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct.html">Code of Conduct</a></li><li><a class="tocitem" href="../license.html">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href="time_stepping.html">16 Explicit time stepping</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="time_stepping.html">16 Explicit time stepping</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="time_stepping"><a class="docs-heading-anchor" href="#time_stepping">16: Explicit time stepping</a><a id="time_stepping-1"></a><a class="docs-heading-anchor-permalink" href="#time_stepping" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/trixi-framework/Trixi.jl/tutorial_notebooks?filepath=tutorials/notebooks/time_stepping.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/trixi-framework/Trixi.jl/blob/tutorial_notebooks/tutorials/notebooks/time_stepping.ipynb"><img src="https://raw.githubusercontent.com/jupyter/design/master/logos/Badges/nbviewer_badge.svg" alt/></a> <a href="https://raw.githubusercontent.com/trixi-framework/Trixi.jl/tutorial_notebooks/tutorials/notebooks/time_stepping.ipynb"><img src="https://camo.githubusercontent.com/aea75103f6d9f690a19cb0e17c06f984ab0f472d9e6fe4eadaa0cc438ba88ada/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f776e6c6f61642d6e6f7465626f6f6b2d627269676874677265656e" alt/></a></p><p>For the time integration, <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a> uses the package <a href="https://github.com/SciML/OrdinaryDiffEq.jl">OrdinaryDiffEq.jl</a> from the SciML ecosystem. The interface to this package is the <code>solve(...)</code> function. It always requires an ODE problem and a time integration algorithm as input parameters.</p><pre><code class="language-julia hljs">solve(ode, alg; kwargs...)</code></pre><p>In Trixi, the ODE problem is created by <code>semidiscretize(semi, tspan)</code> for a semidiscretization <code>semi</code> and the time span <code>tspan</code>. In particular, <a href="../reference-trixi.html#SummationByPartsOperators.semidiscretize-Tuple{SemidiscretizationHyperbolicParabolic, Any}"><code>semidiscretize</code></a> returns an <code>ODEProblem</code> used by OrdinaryDiffEq.jl.</p><p>OrdinaryDiffEq.jl provides many integration algorithms, which are summarized in the <a href="https://diffeq.sciml.ai/stable/solvers/ode_solve/#Full-List-of-Methods">documentation</a>. Particularly interesting for Trixi.jl are their <a href="https://diffeq.sciml.ai/stable/solvers/ode_solve/#Explicit-Strong-Stability-Preserving-Runge-Kutta-Methods-for-Hyperbolic-PDEs-(Conservation-Laws)">strong stability preserving (SSP) methods</a> and <a href="https://diffeq.sciml.ai/stable/solvers/ode_solve/#Low-Storage-Methods">low-storage methods</a>. There are some differences regarding the choice of the used time step.</p><h1 id="Error-based-adaptive-step-sizes"><a class="docs-heading-anchor" href="#Error-based-adaptive-step-sizes">Error-based adaptive step sizes</a><a id="Error-based-adaptive-step-sizes-1"></a><a class="docs-heading-anchor-permalink" href="#Error-based-adaptive-step-sizes" title="Permalink"></a></h1><p>First, we treat time integration algorithms with adaptive step sizes, such as <code>SSPRK43</code>. It is used in some elixirs, like <a href="https://github.com/trixi-framework/Trixi.jl/blob/main/examples/tree_2d_dgsem/elixir_euler_colliding_flow.jl"><code>elixir_euler_colliding_flow.jl</code></a> or <a href="https://github.com/trixi-framework/Trixi.jl/blob/main/examples/tree_2d_dgsem/elixir_euler_astro_jet_amr.jl"><code>elixir_euler_astro_jet_amr.jl</code></a>.</p><p>Other error-based adaptive integration algorithms are for instance <code>RDPK3SpFSAL35</code>, <code>RDPK3Sp35</code>, <code>RDPK3SpFSAL49</code>, <code>RDPK3Sp49</code>, <code>RDPK3SpFSAL510</code>, <code>RDPK3Sp510</code>.</p><p>They already contain an error-based adaptive step size control and heuristics to guess a starting step size. If this heuristic fails in your case, you can specify an appropriately small initial step size as keyword argument <code>dt=...</code> of <code>solve</code>.</p><h1 id="CFL-based-step-size-control"><a class="docs-heading-anchor" href="#CFL-based-step-size-control">CFL-based step size control</a><a id="CFL-based-step-size-control-1"></a><a class="docs-heading-anchor-permalink" href="#CFL-based-step-size-control" title="Permalink"></a></h1><p>The SciML ecosystem also provides time integration algorithms without adaptive time stepping on their own, such as <code>CarpenterKennedy2N54</code>. Moreover, you also can deactivate the automatic adaptivity of adaptive integration algorithms by passing <code>adaptive=false</code> in the <code>solve</code> function.</p><p>These algorithms require another way of setting the step size. You have to pass <code>dt=...</code> in the <code>solve</code> function. Without other settings, the simulation uses this fixed time step.</p><p>For hyperbolic PDEs, it is natural to use an adaptive CFL-based step size control. Here, the time step is proportional to a ratio of the local measure of mesh spacing <span>$\Delta x_i$</span> for an element <code>i</code> and the maximum (local) wave speed <span>$\lambda_{\max}$</span> related to the largest-magnitude eigenvalue of the flux Jacobian of the hyperbolic system.</p><p class="math-container">\[\Delta t_n = \text{CFL} * \min_i \frac{\Delta x_i}{\lambda_{\max}(u_i^n)}\]</p><p>We compute <span>$\Delta x_i$</span> by scaling the element size by a factor of <span>$1/(N+1)$</span>, cf. <a href="https://doi.org/10.1137/100807211">Gassner and Kopriva (2011)</a>, Section 5.</p><p>Trixi provides such a CFL-based step size control. It is implemented as the callback <a href="../reference-trixi.html#Trixi.StepsizeCallback"><code>StepsizeCallback</code></a>.</p><pre><code class="language-julia hljs">stepsize_callback = StepsizeCallback(; cfl=1.0)</code></pre><p>A suitable CFL number depends on many parameters such as the chosen grid, the integration algorithm and the polynomial degree of the spatial DG discretization. So, the optimal number for an example is mostly determined experimentally.</p><p>You can add this CFL-based step size control to your simulation like any other callback.</p><pre><code class="language-julia hljs">callbacks = CallbackSet(stepsize_callback)
alg = CarpenterKennedy2N54(williamson_condition=false)
solve(ode, alg;
      dt=1.0 # solve needs some value here but it will be overwritten by the stepsize_callback
      callback=callbacks)</code></pre><p>You can find simple examples with a CFL-based step size control for instance in the elixirs <a href="https://github.com/trixi-framework/Trixi.jl/blob/main/examples/tree_2d_dgsem/elixir_advection_basic.jl"><code>elixir_advection_basic.jl</code></a> or <a href="https://github.com/trixi-framework/Trixi.jl/blob/main/examples/tree_2d_dgsem/elixir_euler_source_terms.jl"><code>elixir_euler_source_terms.jl</code></a>.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="hohqmesh_tutorial.html">« 15 Unstructured meshes with HOHQMesh.jl</a><a class="docs-footer-nextpage" href="differentiable_programming.html">17 Differentiable programming »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Sunday 2 April 2023 00:22">Sunday 2 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
