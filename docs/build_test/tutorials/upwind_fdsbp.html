<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>8 Upwind FD SBP schemes · Trixi.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://trixi-framework.github.io/Trixi.jl/stable/tutorials\\upwind_fdsbp.html"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Trixi.jl</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../overview.html">Overview</a></li><li><a class="tocitem" href="../visualization.html">Visualization</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="introduction.html">Introduction</a></li><li><a class="tocitem" href="getting_started_with_Trixi.html">1 Getting started with Trixi</a></li><li><a class="tocitem" href="scalar_linear_advection_1d.html">2 Introduction to DG methods</a></li><li><a class="tocitem" href="DGSEM_FluxDiff.html">3 DGSEM with flux differencing</a></li><li><a class="tocitem" href="shock_capturing.html">4 Shock capturing with flux differencing and stage limiter</a></li><li><a class="tocitem" href="non_periodic_boundaries.html">5 Non-periodic boundaries</a></li><li><a class="tocitem" href="DGMulti_1.html">6 DG schemes via <code>DGMulti</code> solver</a></li><li><a class="tocitem" href="DGMulti_2.html">7 Other SBP schemes (FD, CGSEM) via <code>DGMulti</code> solver</a></li><li class="is-active"><a class="tocitem" href="upwind_fdsbp.html">8 Upwind FD SBP schemes</a></li><li><a class="tocitem" href="adding_new_scalar_equations.html">9 Adding a new scalar conservation law</a></li><li><a class="tocitem" href="adding_nonconservative_equation.html">10 Adding a non-conservative equation</a></li><li><a class="tocitem" href="parabolic_terms.html">11 Parabolic terms</a></li><li><a class="tocitem" href="adding_new_parabolic_terms.html">12 Adding new parabolic terms</a></li><li><a class="tocitem" href="adaptive_mesh_refinement.html">13 Adaptive mesh refinement</a></li><li><a class="tocitem" href="structured_mesh_mapping.html">14 Structured mesh with curvilinear mapping</a></li><li><a class="tocitem" href="hohqmesh_tutorial.html">15 Unstructured meshes with HOHQMesh.jl</a></li><li><a class="tocitem" href="time_stepping.html">16 Explicit time stepping</a></li><li><a class="tocitem" href="differentiable_programming.html">17 Differentiable programming</a></li></ul></li><li><span class="tocitem">Basic building blocks</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Meshes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../meshes/tree_mesh.html">Tree mesh</a></li><li><a class="tocitem" href="../meshes/structured_mesh.html">Structured mesh</a></li><li><a class="tocitem" href="../meshes/unstructured_quad_mesh.html">Unstructured mesh</a></li><li><a class="tocitem" href="../meshes/p4est_mesh.html">P4est-based mesh</a></li><li><a class="tocitem" href="../meshes/dgmulti_mesh.html">DGMulti mesh</a></li></ul></li><li><a class="tocitem" href="../time_integration.html">Time integration</a></li><li><a class="tocitem" href="../callbacks.html">Callbacks</a></li></ul></li><li><span class="tocitem">Advanced topics &amp; developers</span><ul><li><a class="tocitem" href="../conventions.html">Conventions</a></li><li><a class="tocitem" href="../development.html">Development</a></li><li><a class="tocitem" href="../github-git.html">GitHub &amp; Git</a></li><li><a class="tocitem" href="../styleguide.html">Style guide</a></li><li><a class="tocitem" href="../testing.html">Testing</a></li><li><a class="tocitem" href="../performance.html">Performance</a></li><li><a class="tocitem" href="../parallelization.html">Parallelization</a></li></ul></li><li><a class="tocitem" href="../troubleshooting.html">Troubleshooting and FAQ</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../reference-trixi.html">Trixi.jl</a></li><li><a class="tocitem" href="../reference-trixi2vtk.html">Trixi2Vtk.jl</a></li></ul></li><li><a class="tocitem" href="../authors.html">Authors</a></li><li><a class="tocitem" href="../contributing.html">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct.html">Code of Conduct</a></li><li><a class="tocitem" href="../license.html">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href="upwind_fdsbp.html">8 Upwind FD SBP schemes</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="upwind_fdsbp.html">8 Upwind FD SBP schemes</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="upwind_fdsbp"><a class="docs-heading-anchor" href="#upwind_fdsbp">8: Upwind FD SBP schemes</a><a id="upwind_fdsbp-1"></a><a class="docs-heading-anchor-permalink" href="#upwind_fdsbp" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/trixi-framework/Trixi.jl/tutorial_notebooks?filepath=tutorials/notebooks/upwind_fdsbp.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/trixi-framework/Trixi.jl/blob/tutorial_notebooks/tutorials/notebooks/upwind_fdsbp.ipynb"><img src="https://raw.githubusercontent.com/jupyter/design/master/logos/Badges/nbviewer_badge.svg" alt/></a> <a href="https://raw.githubusercontent.com/trixi-framework/Trixi.jl/tutorial_notebooks/tutorials/notebooks/upwind_fdsbp.ipynb"><img src="https://camo.githubusercontent.com/aea75103f6d9f690a19cb0e17c06f984ab0f472d9e6fe4eadaa0cc438ba88ada/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f776e6c6f61642d6e6f7465626f6f6b2d627269676874677265656e" alt/></a></p><p>General tensor product SBP methods are supported via the <code>DGMulti</code> solver in a reasonably complete way, see <a href="DGMulti_2.html#DGMulti_2">the previous tutorial</a>. Nevertheless, there is also experimental support for SBP methods with other solver and mesh types.</p><p>The first step is to set up an SBP operator. A classical (central) SBP operator can be created as follows.</p><pre><code class="language-julia hljs">using Trixi
D_SBP = derivative_operator(SummationByPartsOperators.MattssonNordström2004(),
                            derivative_order=1, accuracy_order=2,
                            xmin=0.0, xmax=1.0, N=11)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SBP first-derivative operator of order 2 on a grid in [0.0, 1.0] using 11 nodes 
and coefficients of Mattsson, Nordström (2004) 
  Summation by parts operators for finite difference approximations of second 
    derivatives. 
  Journal of Computational Physics 199, pp. 503-540.</code></pre><p>Instead of prefixing the source of coefficients <code>MattssonNordström2004()</code>, you can also load the package SummationByPartsOperators.jl. Either way, this yields an object representing the operator efficiently. If you want to compare it to coefficients presented in the literature, you can convert it to a matrix.</p><pre><code class="language-julia hljs">Matrix(D_SBP)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11×11 Matrix{Float64}:
 -10.0  10.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0   0.0
  -5.0   0.0   5.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0   0.0
   0.0  -5.0   0.0   5.0   0.0   0.0   0.0   0.0   0.0    0.0   0.0
   0.0   0.0  -5.0   0.0   5.0   0.0   0.0   0.0   0.0    0.0   0.0
   0.0   0.0   0.0  -5.0   0.0   5.0   0.0   0.0   0.0    0.0   0.0
   0.0   0.0   0.0   0.0  -5.0   0.0   5.0   0.0   0.0    0.0   0.0
   0.0   0.0   0.0   0.0   0.0  -5.0   0.0   5.0   0.0    0.0   0.0
   0.0   0.0   0.0   0.0   0.0   0.0  -5.0   0.0   5.0    0.0   0.0
   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -5.0   0.0    5.0   0.0
   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -5.0    0.0   5.0
   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -10.0  10.0</code></pre><p>Upwind SBP operators are a concept introduced in 2017 by Ken Mattsson. You can create them as follows.</p><pre><code class="language-julia hljs">D_upw = upwind_operators(SummationByPartsOperators.Mattsson2017,
                         derivative_order=1, accuracy_order=2,
                         xmin=0.0, xmax=1.0, N=11)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Upwind SBP first-derivative operators of order 2 on a grid in [0.0, 1.0] using 11 nodes 
and coefficients of Mattsson2017</code></pre><p>Upwind operators are derivative operators biased towards one direction. The &quot;minus&quot; variants has a bias towards the left side, i.e., it uses values from more nodes to the left than from the right to compute the discrete derivative approximation at a given node (in the interior of the domain). In matrix form, this means more non-zero entries are left from the diagonal.</p><pre><code class="language-julia hljs">Matrix(D_upw.minus)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11×11 Matrix{Float64}:
 -10.0   10.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0
 -10.0   10.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0
   5.0  -20.0   15.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0
   0.0    5.0  -20.0   15.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0
   0.0    0.0    5.0  -20.0   15.0    0.0    0.0    0.0    0.0    0.0   0.0
   0.0    0.0    0.0    5.0  -20.0   15.0    0.0    0.0    0.0    0.0   0.0
   0.0    0.0    0.0    0.0    5.0  -20.0   15.0    0.0    0.0    0.0   0.0
   0.0    0.0    0.0    0.0    0.0    5.0  -20.0   15.0    0.0    0.0   0.0
   0.0    0.0    0.0    0.0    0.0    0.0    5.0  -20.0   15.0    0.0   0.0
   0.0    0.0    0.0    0.0    0.0    0.0    0.0    4.0  -16.0   10.0   2.0
   0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   20.0  -50.0  30.0</code></pre><p>Analogously, the &quot;plus&quot; variant has a bias towards the right side.</p><pre><code class="language-julia hljs">Matrix(D_upw.plus)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11×11 Matrix{Float64}:
 -30.0   50.0  -20.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0
  -2.0  -10.0   16.0   -4.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0
   0.0    0.0  -15.0   20.0   -5.0    0.0    0.0    0.0    0.0    0.0   0.0
   0.0    0.0    0.0  -15.0   20.0   -5.0    0.0    0.0    0.0    0.0   0.0
   0.0    0.0    0.0    0.0  -15.0   20.0   -5.0    0.0    0.0    0.0   0.0
   0.0    0.0    0.0    0.0    0.0  -15.0   20.0   -5.0    0.0    0.0   0.0
   0.0    0.0    0.0    0.0    0.0    0.0  -15.0   20.0   -5.0    0.0   0.0
   0.0    0.0    0.0    0.0    0.0    0.0    0.0  -15.0   20.0   -5.0   0.0
   0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  -15.0   20.0  -5.0
   0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  -10.0  10.0
   0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  -10.0  10.0</code></pre><p>For more information on upwind SBP operators, please refer to the documentation of <a href="https://github.com/ranocha/SummationByPartsOperators.jl">SummationByPartsOperators.jl</a> and references cited there.</p><p>The basic idea of upwind SBP schemes is to apply a flux vector splitting and use appropriate upwind operators for both parts of the flux. In 1D, this means to split the flux</p><p class="math-container">\[f(u) = f^-(u) + f^+(u)\]</p><p>such that <span>$f^-(u)$</span> is associated with left-going waves and <span>$f^+(u)$</span> with right-going waves. Then, we apply upwind SBP operators <span>$D^-, D^+$</span> with an appropriate upwind bias, resulting in</p><p class="math-container">\[\partial_x f(u) \approx D^+ f^-(u) + D^- f^+(u)\]</p><p>Note that the established notations of upwind operators <span>$D^\pm$</span> and flux splittings <span>$f^\pm$</span> clash. The right-going waves from <span>$f^+$</span> need an operator biased towards their upwind side, i.e., the left side. This upwind bias is provided by the operator <span>$D^-$</span>.</p><p>Many classical flux vector splittings have been developed for finite volume methods and are described in the book &quot;Riemann Solvers and Numerical Methods for Fluid Dynamics: A Practical Introduction&quot; of Eleuterio F. Toro (2009), <a href="https://doi.org/10.1007/b79761">DOI: 10.1007/b79761</a>. One such a well-known splitting provided by Trixi.jl is <a href="../reference-trixi.html#Trixi.splitting_steger_warming-Tuple{Any, Integer, CompressibleEulerEquations1D}"><code>splitting_steger_warming</code></a>.</p><p>Trixi.jl comes with several example setups using upwind SBP methods with flux vector splitting, e.g.,</p><ul><li><a href="https://github.com/trixi-framework/Trixi.jl/blob/main/examples/tree_2d_fdsbp/elixir_euler_vortex.jl"><code>elixir_euler_vortex.jl</code></a></li><li><a href="https://github.com/trixi-framework/Trixi.jl/blob/main/examples/tree_3d_fdsbp/elixir_euler_taylor_green_vortex.jl"><code>elixir_euler_taylor_green_vortex.jl</code></a></li></ul><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="DGMulti_2.html">« 7 Other SBP schemes (FD, CGSEM) via <code>DGMulti</code> solver</a><a class="docs-footer-nextpage" href="adding_new_scalar_equations.html">9 Adding a new scalar conservation law »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 17 April 2023 08:36">Monday 17 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
